"use strict";var gameEngnie={ele:null,allBullets:[],allEnemys:[],allScore:0,init:function(){return gameEngnie.ele=document.getElementById("main"),this},startgame:function(){console.log("开始游戏"),this.loadding(function(){myPlan.init().move(),myPlan.fire(),gameEngnie.listenonkey(),gameEngnie.createenemy(),gameEngnie.crash()})},loadding:function(e){var n=document.createElement("div");n.className="logo",gameEngnie.ele.appendChild(n);var l=document.createElement("div");l.className="lode",gameEngnie.ele.appendChild(l);var a=["images2/loading1.png","images2/loading2.png","images2/loading3.png"],t=0,i=setInterval(function(){t>=5?(clearInterval(i),gameEngnie.ele.removeChild(n),gameEngnie.ele.removeChild(l),e()):l.style.background="url("+a[++t%3]+") no-repeat"},500)},listenonkey:function(){var e=0,n=0;onkeydown=function(l){37==(l=l||event).keyCode?e=-10:38==l.keyCode?n=-10:39==l.keyCode?e=10:40==l.keyCode&&(n=10)},document.onkeyup=function(l){37!=(l=l||event).keyCode&&39!=l.keyCode||(e=0),38!=l.keyCode&&40!=l.keyCode||(n=0)},setInterval(function(){var l=myPlan.ele.offsetLeft+e;l<0?l=0:l>gameEngnie.ele.offsetWidth-myPlan.ele.offsetWidth&&(l=gameEngnie.ele.offsetWidth-myPlan.ele.offsetWidth),myPlan.ele.style.left=l+"px";var a=myPlan.ele.offsetTop+n;a<0&&(a=0),myPlan.ele.style.top=a+"px"},30)},createenemy:function(){this.createbig=setInterval(function(){if(Math.random()>.7){new Enemy(1).init().move()}},6e3),this.createmiddle=setInterval(function(){if(Math.random()>.5){new Enemy(2).init().move()}},2e3),this.createsmall=setInterval(function(){if(Math.random()>.3){new Enemy(3).init().move()}},600)},crash:function(){var e=setInterval(function(){for(var n=0;n<gameEngnie.allEnemys.length;n++){for(var l=0;l<gameEngnie.allBullets.length;l++)isCrash(gameEngnie.allEnemys[n].ele,gameEngnie.allBullets[l].ele)&&(gameEngnie.allBullets[l].boom(),gameEngnie.allBullets.splice(l,1),gameEngnie.allEnemys[n].hurt());if(isCrash(gameEngnie.allEnemys[n].ele,myPlan.ele)){clearInterval(e);for(var a=0;a<gameEngnie.allEnemys.length;a++)clearInterval(gameEngnie.allEnemys[a].timer);clearInterval(myPlan.timer);for(var t=0;t<gameEngnie.allBullets.length;t++)clearInterval(gameEngnie.allBullets[t].timer);clearInterval(gameEngnie.createbig),clearInterval(gameEngnie.createmiddle),clearInterval(gameEngnie.createsmall),myPlan.boom();var i=prompt("留下好汉的大名：");i&&ajax({type:"post",url:"http://60.205.181.47/myPHPCode4/uploadScore.php",data:{name:i,score:gameEngnie.allScore},success:function(e){console.log(e),location.href="zhanji.html"},fail:function(e){console.log("请求失败！")}}),console.log("Game Over!");break}}},20)}};